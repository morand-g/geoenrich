const translations = {
  en: {
    title: "GeoEnrich online",
    selectFile: "Select your occurrences file*:",
    formattingExamples: "Formatting examples",
    chooseFile: "Choose file or drag here",
    chooseVariable: "Choose a variable*:",
    catalog: "Catalog",
    bufferBoundaries: "Choose your buffer boundaries:",
    geoBuffer: "Geographical buffer (km):",
    timeStart: "Time period start (days):",
    timeEnd: "Time period end (days):",
    allDepths: "Use all depths level instead of surface only (not recommended)",
    continue: "Continue",
    documentation: "Documentation",
    codeSupport: "Code & Support",
    processingFile: "Processing your file... please wait ⏳",
    g2oiProject: "This website is being developed as part of the G2OI project, cofinanced by the European union, the Reunion region, and the French Republic.",
    download: "Download",
    previewFile: "Preview File",
    hidePreview: "Hide Preview",
    preview: "Preview",
    summaryStats: "Summary Stats",
    fileTooLarge: "The file is too large! Maximum allowed size is 20 MB.",
    uploadFileError: "Please upload your occurrences file",
    chooseVariableError: "Please choose a variable.",
    user_email: "Enter your mail to get a  download link:"
  },
  fr: {
    title: "GeoEnrich en ligne",
    selectFile: "Sélectionnez votre fichier d'occurrences*:",
    formattingExamples: "Exemples de formatage",
    chooseFile: "Choisissez un fichier ou glissez ici",
    chooseVariable: "Choisissez une variable*:",
    catalog: "Catalogue",
    bufferBoundaries: "Choisissez vos limites de buffer :",
    geoBuffer: "Buffer géographique (km) :",
    timeStart: "Début de la période (jours) :",
    timeEnd: "Fin de la période (jours) :",
    allDepths: "Utiliser tous les niveaux de profondeur au lieu de la surface seulement (non recommandé)",
    continue: "Continuer",
    documentation: "Documentation",
    codeSupport: "Code & Support",
    processingFile: "Traitement de votre fichier... veuillez patienter ⏳",
    g2oiProject: "Ce site web est développé dans le cadre du projet G2OI, cofinancé par l'Union européenne, la région Réunion et la République française.",
    download: "Télécharger",
    previewFile: "Aperçu du fichier",
    hidePreview: "Masquer l'aperçu",
    summaryStats: "Statistiques résumées",
    preview: "Aperçu",
    fileTooLarge: "Le fichier est trop volumineux. La taille maximale autorisée est de 20 Mo.",
    uploadFileError: "Veuillez télécharger votre fichier d'occurrences",
    chooseVariableError: "Veuillez choisir une variable.",
    user_email: "Entrez votre e-mail pour obtenir un lien de téléchargement :"
  },
  es: {
    title: "GeoEnrich en línea",
    selectFile: "Seleccione su archivo de ocurrencias*:",
    formattingExamples: "Ejemplos de formato",
    chooseFile: "Elija un archivo o arrástrelo aquí",
    chooseVariable: "Elija una variable*:",
    catalog: "Catálogo",
    bufferBoundaries: "Elija los límites del buffer:",
    geoBuffer: "Buffer geográfico (km):",
    timeStart: "Inicio del período (días):",
    timeEnd: "Fin del período (días):",
    allDepths: "Usar todos los niveles de profundidad en lugar de solo la superficie (no recomendado)",
    continue: "Continuar",
    documentation: "Documentación",
    codeSupport: "Código y Soporte",
    processingFile: "Procesando su archivo... por favor espere ⏳",
    g2oiProject: "Este sitio web se desarrolla como parte del proyecto G2OI, cofinanciado por la Unión Europea, la región de Reunión y la República Francesa.",
    download: "Descargar",
    previewFile: "Vista previa del archivo",
    hidePreview: "Ocultar vista previa",
    summaryStats: "Estadísticas resumidas",
    preview:"avance",
    fileTooLarge: "El archivo es demasiado grande. El tamaño máximo permitido es de 20 MB.",
    uploadFileError: "Por favor, sube tu archivo de ocurrencias",
    chooseVariableError: "Por favor, elige una variable.",
    user_email: "Introduce tu correo electrónico para recibir un enlace de descarga:"
  },
  ar: {
  title: "GeoEnrich عبر الإنترنت",
  selectFile: "اختر ملف الوقوعات الخاص بك*:",
  formattingExamples: "أمثلة على التنسيق",
  chooseFile: "اختر ملفاً أو اسحب هنا",
  chooseVariable: "اختر متغيراً*:",
  catalog: "الفهرس",
  bufferBoundaries: "اختر حدود منطقة العزل:",
  geoBuffer: "منطقة عزل جغرافية (كم):",
  timeStart: "بداية الفترة الزمنية (أيام):",
  timeEnd: "نهاية الفترة الزمنية (أيام):",
  allDepths: "استخدام جميع مستويات العمق بدلاً من السطح فقط (غير مستحسن)",
  continue: "متابعة",
  documentation: "التوثيق",
  codeSupport: "الكود والدعم",
  processingFile: "جارٍ معالجة الملف... يرجى الانتظار ⏳",
  g2oiProject: "يتم تطوير هذا الموقع كجزء من مشروع G2OI، بتمويل مشترك من الاتحاد الأوروبي، ومنطقة ريونيون، والجمهورية الفرنسية.",
  download: "تنزيل",
  previewFile: "معاينة الملف",
  hidePreview: "إخفاء المعاينة",
  preview: "معاينة",
  summaryStats: "إحصائيات ملخصة",
  fileTooLarge: "الملف كبير جداً! الحد الأقصى المسموح به هو 20 ميغابايت.",
  uploadFileError: "يرجى رفع ملف الوقوعات الخاص بك",
  chooseVariableError: "يرجى اختيار متغير.",
  user_email: "أدخل بريدك الإلكتروني للحصول على رابط التنزيل:"
},
zh: {
  title: "GeoEnrich 在线",
  selectFile: "选择您的发生文件*：",
  formattingExamples: "格式示例",
  chooseFile: "选择文件或拖拽到此处",
  chooseVariable: "选择一个变量*：",
  catalog: "目录",
  bufferBoundaries: "选择您的缓冲区边界：",
  geoBuffer: "地理缓冲区（公里）：",
  timeStart: "时间段开始（天）：",
  timeEnd: "时间段结束（天）：",
  allDepths: "使用所有深度级别而不仅仅是表面（不推荐）",
  continue: "继续",
  documentation: "文档",
  codeSupport: "代码与支持",
  processingFile: "正在处理您的文件...请稍候 ⏳",
  g2oiProject: "本网站作为 G2OI 项目的一部分开发，由欧盟、留尼汪地区和法兰西共和国共同资助。",
  download: "下载",
  previewFile: "预览文件",
  hidePreview: "隐藏预览",
  preview: "预览",
  summaryStats: "摘要统计",
  fileTooLarge: "文件太大！允许的最大大小为 20 MB。",
  uploadFileError: "请上传您的发生文件",
  chooseVariableError: "请选择一个变量。",
  user_email: "请输入您的电子邮件以获取下载链接："
}
};

// Function to apply translations
function setLanguage(lang) {
  localStorage.setItem('selectedLang', lang); // save selection
  const select = document.getElementById("language-select");
  if (select) select.value = lang;

  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n');
    if(translations[lang] && translations[lang][key]){
      if (el.tagName === "INPUT" && (el.type === "submit" || el.type === "button")) {
        el.value = translations[lang][key]; // for buttons
      } else {
        el.textContent = translations[lang][key];
      }
    }
  });
}

// Apply language after DOM is ready
document.addEventListener('DOMContentLoaded', () => {
  let userLang = localStorage.getItem('selectedLang');

  if (!userLang) {
    // fallback to browser language
    userLang = navigator.language || navigator.userLanguage;

    if (userLang.startsWith('en')) userLang = 'en';
    else if (userLang.startsWith('es')) userLang = 'es';
    else if (userLang.startsWith('fr')) userLang = 'fr';
    else if (userLang.startsWith('ar')) userLang = 'ar';
    else if (userLang.startsWith('zh')) userLang = 'zh';
    else userLang = 'fr'; // default to French
  }

  setLanguage(userLang);

  // Listen for changes in the language select dropdown
  const select = document.getElementById('language-select');
  if(select){
    select.addEventListener('change', (e) => setLanguage(e.target.value));
  }
});